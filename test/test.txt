1.1.1.	测试工具实现
接口模型挖掘的一体化集成测试工具以自然语言形式的功能场景流程描述作为输入，首先通过基于自然语言理解的事件流挖掘，获得关于被测系统功能流程的事件流模式和接口交互模型。在此基础上，可选融合基于历史报文的流程挖掘，进一步获得较为完整的系统接口模型。基于接口模型，依托模型分析自动生成测试用例，通过测试执行引擎自动执行用例、完成发布-订阅模式测试报文收发，并获取测试结果，从而实现对被测目标的功能验证。
	工具主要功能：
基于自然语言理解的事件流挖掘、基于历史信息的事件流挖掘、事件流模型融合与接口模型构建、基于接口模型的测试用例生成、集成边界控制与测试自动执行，以及测试数据管理等。
	工具输入输出：
输入：自然语言形式的场景流程描述、描述系统组件及其接口关联的领域知识图谱、历史报文序列、接口格式文档等
输出：被测系统接口模型、测试用例以及测试执行结果
集成测试工具主要按以下流程来实现对目标系统的测试：
(1)	新建场景模式
本步骤首先打开工具的场景模型视图，点击左上方的新建按钮，弹出场景模式创建窗口，输入场景名称与场景描述完成模式创建。场景描述以自然语言形式提供，表达了被测对象上的一个或多个功能流程，每个流程由一系列存在关联的事件构成。测试工具将提取场景描述中包含的事件流信息，构建系统接口模型，来支撑测试用例的自动生成。
 
图34 新建场景模式
(2)	事件流和接口模型抽取
右键选中测试场景，点击序列模式抽取，测试工具将基于流程的自然语言描述进行事件流模式和接口模型挖掘。其中，事件流模式是对场景描述的抽象表达，以格式化表达的方式提炼了流程描述中信息交互顺序。以生成战场综合态势为例，其场景流程描述如下。
经过测试工具处理得到格式化的事件流模式输出，结果如下。
接口模型挖掘则进一步将文本化表达的事件和系统中的接口报文进行关联绑定，得到表达接口报文交互时序的系统接口模型。文本化事件和具体接口的关联通过融合知识图谱的混合匹配方法实现，具体实现为两阶段的匹配任务链。首先，测试工具会读取接口关联的领域知识图谱信息，然后根据该信息并结合上一步获取的事件流信息实现接口匹配。在实现过程中，测试工具首先会解析事件流信息，获取报文事件的发起方A和接收方B以及发送的报文M，然后通过A和B检索领域知识图谱获取A和B之间所有可能的发送报文并与报文M匹配，匹配成功则完成绑定，中止任务流。匹配失败则进入第二阶段，直接获取测试工具中定义的所有的接口报文进行匹配，若匹配成功则完成绑定，否则认为接口报文绑定失败，忽略该信息继续下一个接口报文匹配。同样以生成战场态势为例，测试工具通过上一步提取的事件流模式，逐个解析报文事件并进行接口报文绑定，最终得到的结果如下。
在这一阶段，测试工具过滤了无效或可忽略的报文事件，并可视化展示测试用例生成所需的交互序列。

 
图35 序列模式抽取
(3)	测试用例生成
右键选中测试场景，点击生成测试用例，测试工具将读取场景背后表达的系统接口模型，通过基于模型的测试生成算法自动完成测试用例的构造。在生成测试用例时可以选择不同的生成策略，例如生成对应数据类型边界值的边界策略、在指定范围内随机生成数据的随机策略以及更为复杂的混合生成策略等，每种策略有着不同的效果，使得生成的测试用例复杂、多样。
 

 
 
图36 测试用例生成
(4)	设定集成边界
为有效开展集成测试，需要划定被测目标的集成边界，处在集成边界外的系统激励消息等将由测试用例来模拟，而集成边界内的组件间报文交互等则由边界内的实体自行完成，体现这些边界内实体在外部激励驱动下的行为模式。
双击测试场景的系统边界表项，将弹出集成边界设置窗口，以树状结构呈现被测系统所有对外开放的接口，选中接口则代表暂时中断该接口的正常工作，由测试用例来接管，测试用例模拟不同的集成边界外组件交互消息来驱动被测目标不同的功能行为。
 
图37 集成边界设置
(5)	执行测试用例
打开系统测试用例视图，右键选中生成的测试用例，点击运行，即可开展对被测目标的测试任务。测试用例的执行依托发布订阅模式实现，发布-订阅机制具有松耦合、高度灵活、可扩展性高等显著优势。在实际通信时，作为发布者的模块将消息发送到通道中，作为接收者的模块通过订阅对应的主题实现对消息的接收。
测试用例发出的报文激励将被被测目标接收，被测目标将在其显控组件、数据库、日志系统等中给出对激励的响应，由此可以见到测试用例的执行效果。
 
图38 测试用例执行
(6)	测试结果查看
打开测试结果视图，该界面记录并展示项目运行后所有采集的测试结果数据，包括由被测目标输出的响应报文等，可以查看具体的执行结果，评估被测目标功能实现是否正常。
 
图39 测试结果查看
